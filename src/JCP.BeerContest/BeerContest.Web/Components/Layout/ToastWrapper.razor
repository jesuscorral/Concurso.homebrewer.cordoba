@using BeerContest.Web.Services
@inject ToastService ToastService
@implements IDisposable

<div class="toast-container">
    @foreach (var toast in ToastService.Toasts.Where(t => t.IsVisible))
    {
        <div class="toast toast-@(toast.Type.ToString().ToLower()) fade-in" role="alert">
            <div class="toast-content">
                <div class="toast-icon">
                    @if (toast.Type == ToastType.Success)
                    {
                        <i class="fa fa-check-circle"></i>
                    }
                    else if (toast.Type == ToastType.Error)
                    {
                        <i class="fa fa-exclamation-triangle"></i>
                    }
                    else if (toast.Type == ToastType.Warning)
                    {
                        <i class="fa fa-exclamation-circle"></i>
                    }
                    else if (toast.Type == ToastType.Info)
                    {
                        <i class="fa fa-info-circle"></i>
                    }
                </div>
                <div class="toast-message">
                    @toast.Message
                </div>
                <button class="toast-close" @onclick="() => ToastService.RemoveToast(toast.Id)">
                    <i class="fa fa-times"></i>
                </button>
            </div>
        </div>
    }
</div>

@code {
    protected override void OnInitialized()
    {
        ToastService.OnToastChanged += StateHasChanged;
    }
    
    public void Dispose()
    {
        ToastService.OnToastChanged -= StateHasChanged;
    }
}
